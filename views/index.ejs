<!doctype html>
<html lang="en">
<%- include('partials/head'); %>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-KCDB571HMJ"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-KCDB571HMJ');
    </script>

    <body>
        <%- include('partials/navbar'); %>
            <div class="main">
                <span class="float-end visitor-counter"><span id="visitor-counter"></span></span>
                <div class="text-center banner fixed-bottom mx-auto"
                    style="margin-bottom: 0rem!important; padding-bottom: 1rem;">
                    <h1 class="display-1 text-danger">
                        The
                        Visible Bottleneck
                    </h1>
                    <a href="/game" class="btn btn-outline-danger btn-lg px-4 mt-3 play-game-btn" role="button"
                        style="background-color: black;">Test
                        Your
                        Multitasking</a>
                </div>
            </div>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js"
                integrity="sha512-3gJwYpMe3QewGELv8k/BX9vcqhryRdzRMxVfq6ngyWXwo03GFEzjsUm8Q7RZcHPHksttq7/GFoxjCVUjkjvPdw=="
                crossorigin="anonymous" referrerpolicy="no-referrer"></script>
            <script>

                // Get client's IP address.
                $.getJSON('https://api.ipify.org?format=jsonp&callback=?', function (data) {

                    // console.log(JSON.stringify(data, null, 2));
                    // console.log(data.ip)

                    const requestOptions = {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({
                            clientIPAddress: data.ip
                        })
                    };
                    var url = '/api/visitor-counter'
                    fetch(url, requestOptions)

                });

                fetch('/api/visitor-counter')
                    .then(res => res.json())
                    .then(function (res) {
                        // console.log(res.count)
                        const visitorCounter = document.getElementById("visitor-counter");
                        visitorCounter.innerHTML = res.count;

                    })

            </script>

    </body>

</html>